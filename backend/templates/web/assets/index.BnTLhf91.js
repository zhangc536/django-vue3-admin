import{m as N,c as T,X as f,z as U}from"./index.WrgjqPzT.js";import{a as q,c as z}from"./crud.DsplOwbD.js";import{d as E,h as X,c as O,k as s,b as P,o as $,w as e,e as h,l as t,x as j,u as m,q as _,s as A}from"./vue.UJNVWY_g.js";const G={style:{height:"500px"}},L=E({__name:"index",props:{refreshCallback:{type:Function,required:!0}},setup(b,{expose:k}){const x=b,r=X(!1),i=x.refreshCallback,d=()=>{r.value=!1,l.value=[]},C=async()=>{l.value.length!==0&&(await q(g.value.getSearchFormData().role_id,f.pluck(l.value,"id")).then(a=>{U(a.msg)}),i&&i(),d())},{crudBinding:y,crudRef:g,crudExpose:u,selectedRows:l}=N({createCrudOptions:z,context:{}}),{setSearchFormData:R,doRefresh:w}=u,v=O(()=>l.value.length),D=a=>{const o=u.getBaseTableRef(),n=u.getTableData();f.pluck(n,"id").includes(a.id)?o.toggleRowSelection(a,!1):l.value=f.remove(l.value,c=>c.id!==a.id)};return k({dialog:r,setSearchFormData:R,doRefresh:w,parentRefreshCallbackFunc:i}),(a,o)=>{const n=s("el-button"),c=s("el-table-column"),V=s("el-table"),B=s("el-popover"),S=s("fs-crud"),F=s("el-dialog");return $(),P(F,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=p=>r.value=p),title:"添加授权用户",direction:"rtl","destroy-on-close":"","before-close":d},{footer:e(()=>[h("div",null,[t(n,{type:"primary",onClick:C},{default:e(()=>[...o[1]||(o[1]=[_(" 确定",-1)])]),_:1}),t(n,{onClick:d},{default:e(()=>[...o[2]||(o[2]=[_(" 取消",-1)])]),_:1})])]),default:e(()=>[h("div",G,[t(S,j({ref_key:"crudRef",ref:g},m(y)),{"pagination-right":e(()=>[t(B,{placement:"top",width:200,trigger:"click"},{reference:e(()=>[t(n,{text:"",type:v.value>0?"primary":""},{default:e(()=>[_("已选中"+A(v.value)+"条数据",1)]),_:1},8,["type"])]),default:e(()=>[t(V,{data:m(l),size:"small","max-height":500},{default:e(()=>[t(c,{width:"100",property:"name",label:"用户名"}),t(c,{fixed:"right",label:"操作","min-width":"50"},{default:e(p=>[t(n,{text:"",type:"info",icon:m(T),onClick:H=>D(p.row),circle:""},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},16)])]),_:1},8,["modelValue"])}}});export{L as default};
