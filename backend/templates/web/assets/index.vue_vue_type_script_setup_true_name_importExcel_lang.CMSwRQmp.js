import{g as E,S as L,d as y,r as N,E as R}from"./index.WrgjqPzT.js";import{d as k,i as $,h as p,k as v,y as j,a as _,o as b,l as o,w as t,z as q,q as i,A,e as n,u as d}from"./vue.UJNVWY_g.js";const D={style:{display:"inline-block"}},O={class:"dialog-footer"},h=k({name:"importExcel"}),K=k({...h,props:{upload:{type:Object,default(){return{open:!0,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"JWT "+L.get("token")},url:E()+"api/system/file/"}}},api:{type:String,default(){}}},setup(w){const C=$("refreshView");let a=w,s=p(!1);const f=p(),u=p(!1),m=p(!1),V=function(){u.value=!0},S=function(){y({url:a.api+"import_data/",params:{},method:"get"})},B=function(){y({url:a.api+"update_template/",params:{},method:"get"})},F=function(r,e,l){m.value=!0},z=function(r,e,l){return m.value=!1,s.value=!0,f.value.clearFiles(),N({url:a.api+"import_data/",method:"post",data:{url:r.data.url}}).then(g=>{s.value=!1,R.alert("导入成功","导入完成",{confirmButtonText:"OK",callback:x=>{C()}})}).catch(()=>{s.value=!1})},T=function(){f.value.submit()};return(r,e)=>{const l=v("el-button"),g=v("el-upload"),x=v("el-dialog"),U=j("loading");return b(),_("div",D,[o(l,{size:"default",type:"success",onClick:e[0]||(e[0]=c=>V())},{default:t(()=>[q(r.$slots,"default",{},()=>[e[3]||(e[3]=i("导入",-1))])]),_:3}),o(x,{title:d(a).upload.title,modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=c=>u.value=c),width:"400px","append-to-body":""},{footer:t(()=>[n("div",O,[o(l,{type:"primary",disabled:d(s),onClick:T},{default:t(()=>[...e[9]||(e[9]=[i("确 定",-1)])]),_:1},8,["disabled"]),o(l,{disabled:d(s),onClick:e[1]||(e[1]=c=>u.value=!1)},{default:t(()=>[...e[10]||(e[10]=[i("取 消",-1)])]),_:1},8,["disabled"])])]),default:t(()=>[A((b(),_("div",null,[o(g,{ref_key:"uploadRef",ref:f,limit:1,accept:".xlsx, .xls",headers:d(a).upload.headers,action:d(a).upload.url,disabled:m.value,"on-progress":F,"on-success":z,"auto-upload":!1,drag:""},{tip:t(()=>[...e[4]||(e[4]=[n("div",{class:"el-upload__tip",style:{color:"red"}},"提示：仅允许导入“xls”或“xlsx”格式文件！",-1)])]),default:t(()=>[e[5]||(e[5]=n("i",{class:"el-icon-upload"},null,-1)),e[6]||(e[6]=n("div",{class:"el-upload__text"},[i(" 将文件拖到此处，或 "),n("em",null,"点击上传")],-1))]),_:1},8,["headers","action","disabled"]),n("div",null,[o(l,{type:"warning",style:{"font-size":"14px","margin-top":"20px"},onClick:S},{default:t(()=>[...e[7]||(e[7]=[i("下载导入模板",-1)])]),_:1}),o(l,{type:"warning",style:{"font-size":"14px","margin-top":"20px"},onClick:B},{default:t(()=>[...e[8]||(e[8]=[i("批量更新模板",-1)])]),_:1})])])),[[U,d(s)]])]),_:1},8,["title","modelValue"])])}}});export{K as _};
