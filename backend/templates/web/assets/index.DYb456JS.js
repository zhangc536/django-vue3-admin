const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.BnTLhf91.js","assets/index.WrgjqPzT.js","assets/vue.UJNVWY_g.js","assets/index.DDQIcbhy.css","assets/crud.DsplOwbD.js"])))=>i.map(i=>d[i]);
import{m as z,a as A,c as M,X as f,C as q,E as F,z as O,_ as X}from"./index.WrgjqPzT.js";import{d as $,h as b,c as I,k as r,b as L,o as j,w as e,l as t,x as G,u as a,A as H,q as i,D as J,s as h,P as K,e as Q}from"./vue.UJNVWY_g.js";import{a as W}from"./authFunction.BFEqkD6U.js";import{r as Y,c as Z}from"./crud.BuHDKjgU.js";import{R as ee}from"./RoleUserStores.BIizN4sw.js";const ce=$({__name:"index",setup(te,{expose:w}){const d=ee(),R=K(()=>X(()=>import("./index.BnTLhf91.js"),__vite__mapDeps([0,1,2,3,4]))),m=b(),x=()=>{n.doRefresh()},k=b(!1),y=l=>{o.value=[],l()},u=I(()=>o.value.length),C=l=>{const s=n.getBaseTableRef(),p=n.getTableData();f.pluck(p,"id").includes(l.id)?s.toggleRowSelection(l,!1):o.value=f.remove(o.value,c=>c.id!==l.id)},D=async()=>{if(o.value.length<1){q("请先勾选用户");return}await F.confirm(`确定要删除这 “${o.value.length}” 位用户的权限吗`,"确认");const l=await Y(g.value.getSearchFormData().role_id,f.pluck(o.value,"id"));o.value=[],O(l.msg),n.doRefresh()},{crudBinding:V,crudRef:g,crudExpose:n,selectedRows:o}=z({createCrudOptions:Z,context:{subUserRef:m}}),{setSearchFormData:S,doRefresh:U}=n;return w({drawer:k,setSearchFormData:S,doRefresh:U}),(l,s)=>{const p=r("el-tag"),c=r("el-button"),v=r("el-table-column"),B=r("el-table"),E=r("el-popover"),N=r("el-tooltip"),P=r("fs-crud"),T=r("el-drawer");return j(),L(T,{size:"70%",modelValue:a(d).drawerVisible,"onUpdate:modelValue":s[0]||(s[0]=_=>a(d).drawerVisible=_),direction:"rtl","destroy-on-close":"","before-close":y},{header:e(()=>[Q("div",null,[s[1]||(s[1]=i(" 当前授权角色： ",-1)),t(p,null,{default:e(()=>[i(h(a(d).role_name),1)]),_:1})])]),default:e(()=>[t(P,G({ref_key:"crudRef",ref:g},a(V)),{"pagination-right":e(()=>[t(E,{placement:"top",width:200,trigger:"click"},{reference:e(()=>[t(c,{text:"",type:u.value>0?"primary":""},{default:e(()=>[i("已选中"+h(u.value)+"条数据",1)]),_:1},8,["type"])]),default:e(()=>[t(B,{data:a(o),size:"small","max-height":500},{default:e(()=>[t(v,{width:"100",property:"name",label:"用户名"}),t(v,{fixed:"right",label:"操作","min-width":"60"},{default:e(_=>[t(c,{text:"",type:"info",icon:a(M),onClick:oe=>C(_.row),circle:""},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),"pagination-left":e(()=>[t(N,{content:"批量删除所选择的用户权限"},{default:e(()=>[H(t(c,{type:"danger",onClick:D,icon:a(A)},{default:e(()=>[...s[2]||(s[2]=[i("批量删除",-1)])]),_:1},8,["icon"]),[[J,u.value>0&&a(W)("role:SetMenu")]])]),_:1})]),_:1},16),t(a(R),{ref_key:"subUserRef",ref:m,refreshCallback:x},null,512)]),_:1},8,["modelValue"])}}});export{ce as default};
