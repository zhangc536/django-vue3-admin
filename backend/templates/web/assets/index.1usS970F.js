import{g as G}from"./index.es.DmevZXPX.js";import{a7 as H,a8 as J,P as C}from"./index.WrgjqPzT.js";import{_ as T}from"./index.vue_vue_type_script_setup_true_name_svgIcon_lang.B-t1bxEh.js";import{m as K,a as W,l as X}from"./api.BrlENiTv.js";import{d as Y,h as _,v as Z,k as i,y as ee,a as w,o as r,l as t,e as M,u as g,$ as te,q as b,w as n,s as y,A as v,b as k,F as ae,E as ne,t as oe}from"./vue.UJNVWY_g.js";import{_ as le}from"./_plugin-vue_export-helper.DlAUqK2U.js";const se={class:"menu-tree-com"},ie={class:"mtc-head"},ce={key:0,class:"text-center font-black font-normal"},re={key:1,class:"text-center font-black text-red-700 font-normal"},de={class:"mtc-tags"},ue=Y({__name:"index",props:{treeData:{default:()=>[]}},emits:["treeClick","deleteDept","updateDept"],setup(E,{expose:V,emit:B}){const $=G(ne),U={children:"children",label:"name",icon:"icon",isLeaf:(a,e)=>!e.data.is_catalog},x=_(),h=B;let u=_(""),f=_(!1),l=_({}),z=_(null);Z(u,a=>{x.value.filter(a)});const F=(a,e)=>a?oe(e).name.indexOf(a)!==-1:!0,P=(a,e)=>{a.level!==0&&X({parent:a.data.id}).then(c=>{e(c.data)})},R=(a,e)=>{l.value=a,z.value=e,h("treeClick",a)},L=a=>{if(a==="update"){if(!l.value.id){C("请选择菜单！");return}h("updateDept",a,l.value)}else h("updateDept",a)},S=()=>{if(!l.value.id){C("请选择菜单！");return}h("deleteDept",l.value.id,()=>{l.value={}})},N=async a=>{var s;if(!l.value.id){C("请选择菜单！");return}if(f.value)return;const e=((s=z.value)==null?void 0:s.parent.childNodes)||[],c=e.findIndex(m=>m.data.id===l.value.id),D=e.find(m=>m.data.id===l.value.id);if(a==="up"){if(c===0)return;e.splice(c-1,0,D),e.splice(c+1,1),f.value=!0,await K({menu_id:l.value.id}),f.value=!1}a==="down"&&(e.splice(c+2,0,D),e.splice(c,1),f.value=!0,await W({menu_id:l.value.id}),f.value=!1)};return V({treeRef:x}),(a,e)=>{const c=i("el-input"),D=i("Menu"),s=i("el-icon"),m=i("QuestionFilled"),d=i("el-tooltip"),I=i("Plus"),Q=i("Edit"),q=i("Top"),A=i("Bottom"),O=i("Delete"),p=ee("auth");return r(),w(ae,null,[t(c,{modelValue:g(u),"onUpdate:modelValue":e[0]||(e[0]=o=>te(u)?u.value=o:u=o),"prefix-icon":g(H),placeholder:"请输入菜单名称"},null,8,["modelValue","prefix-icon"]),M("div",se,[M("div",ie,[t(s,{size:"16",color:"#606266",class:"mtc-head-icon"},{default:n(()=>[t(D)]),_:1}),e[6]||(e[6]=b(" 菜单列表 ",-1)),t(d,{effect:"dark",placement:"right",content:"1.红色菜单代表状态禁用; 2.添加菜单，如果是目录，组件地址为空即可; 3.添加根节点菜单，父级ID为空即可; 4.支持拖拽菜单;"},{default:n(()=>[t(s,{size:"16",color:"var(--el-color-primary)",class:"mtc-tooltip"},{default:n(()=>[t(m)]),_:1})]),_:1})]),t(g(J),{ref_key:"treeRef",ref:x,data:E.treeData,props:U,"filter-node-method":F,load:P,lazy:"",indent:45,onNodeClick:R,"highlight-current":""},{default:n(({node:o,data:j})=>[t(g($),{node:o,showLabelLine:!1,indent:32},{default:n(()=>[j.status?(r(),w("span",ce,[t(T,{name:o.data.icon,color:"var(--el-color-primary)"},null,8,["name"]),b("  "+y(o.label),1)])):(r(),w("span",re,[t(T,{name:o.data.icon},null,8,["name"]),b(" "+y(o.label),1)]))]),_:2},1032,["node"])]),_:1},8,["data"]),M("div",de,[t(d,{effect:"dark",content:"新增"},{default:n(()=>[v((r(),k(s,{size:"16",onClick:e[1]||(e[1]=o=>L("create")),class:"mtc-tags-icon"},{default:n(()=>[t(I)]),_:1})),[[p,"menu:Create"]])]),_:1}),t(d,{effect:"dark",content:"编辑"},{default:n(()=>[v((r(),k(s,{size:"16",onClick:e[2]||(e[2]=o=>L("update")),class:"mtc-tags-icon"},{default:n(()=>[t(Q)]),_:1})),[[p,"menu:Update"]])]),_:1}),t(d,{effect:"dark",content:"上移"},{default:n(()=>[v((r(),k(s,{size:"16",onClick:e[3]||(e[3]=o=>N("up")),class:"mtc-tags-icon"},{default:n(()=>[t(q)]),_:1})),[[p,"menu:MoveUp"]])]),_:1}),t(d,{effect:"dark",content:"下移"},{default:n(()=>[v((r(),k(s,{size:"16",onClick:e[4]||(e[4]=o=>N("down")),class:"mtc-tags-icon"},{default:n(()=>[t(A)]),_:1})),[[p,"menu:MoveDown"]])]),_:1}),t(d,{effect:"dark",content:"删除"},{default:n(()=>[v((r(),k(s,{size:"16",onClick:e[5]||(e[5]=o=>S()),class:"mtc-tags-icon"},{default:n(()=>[t(O)]),_:1})),[[p,"menu:Delete"]])]),_:1})])])],64)}}}),he=le(ue,[["__scopeId","data-v-027d3c6f"]]);export{he as default};
