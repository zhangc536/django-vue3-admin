import{d as q,M as k,Q as E,R as U,g as F,h as B,c as T,j as N,a0 as A,k as u,a as R,o as $,l as s,m as D,w as o,e as y,f as V,s as M,_ as j,F as z}from"./vue.UJNVWY_g.js";import{W as K,u as O,Y as L,$ as G,G as J,g as Q,a0 as W,a1 as Y,C as I,D as Z,b as H,N as X}from"./index.WrgjqPzT.js";import{a as x}from"./formatTime.in1fXasu.js";import{a as ee}from"./api.BD2T9qvO.js";import{_ as se}from"./_plugin-vue_export-helper.DlAUqK2U.js";const oe=q({name:"changePwd",setup(){const{t:e}=K.useI18n(),n=O(),{themeConfig:P}=k(n),{userInfos:b}=k(L()),p=E(),_=U(),t=F({isShowPassword:!1,ruleForm:{username:"",password:"",password_regain:""},loading:{signIn:!1}}),d=F({username:[{required:!0,message:"请填写账号",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"},{validator:(m,a,r)=>{const w=new RegExp("(?=.*[0-9])(?=.*[a-zA-Z]).{8,30}");a===""?r(new Error("请输入密码")):w.test(a)?(t.ruleForm.password!==""&&i.value.validateField("password"),r()):r(new Error("您的密码复杂度太低(密码中必须包含字母、数字)"))},trigger:"blur"}],password_regain:[{required:!0,message:"请填写密码",trigger:"blur"},{validator:(m,a,r)=>{a===""?r(new Error("请再次输入密码")):a!==t.ruleForm.password?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}]}),i=B(),f=T(()=>x(new Date)),h=async()=>{window.open(Q("/api/system/apply_for_trial/"))},l=async()=>{i.value&&await i.value.validate(m=>{m?ee(t.ruleForm).then(a=>{a.code===2e3&&(P.value.isRequestRoutes?(Y(),C()):(W(),C()))}).catch(a=>{I("登录失败")}):I("请填写登录信息")})},C=()=>{var r,w,v,S;Z().getSystemDictionarys();let m=f.value;(r=p.query)!=null&&r.redirect?_.push({path:(w=p.query)==null?void 0:w.redirect,query:Object.keys((v=p.query)==null?void 0:v.params).length>0?JSON.parse((S=p.query)==null?void 0:S.params):""}):_.push("/"),t.loading.signIn=!0;const a=e("message.signInText");H.success(`${m}，${a}`),X.start()};return N(()=>{t.ruleForm.username=G.get("username"),J().getSystemConfigs()}),{loginClick:l,loginSuccess:C,state:t,formRef:i,rules:d,applyBtnClick:h,showApply:()=>window.location.href.indexOf("public")!=-1,...A(t)}}}),ne={key:0,style:{"text-align":"center"}};function ae(e,n,P,b,p,_){const t=u("ele-User"),c=u("el-icon"),g=u("el-input"),d=u("el-form-item"),i=u("ele-Unlock"),f=u("el-button"),h=u("el-form");return $(),R(z,null,[s(h,{ref:"formRef",size:"large",class:"login-content-form",model:e.state.ruleForm,rules:e.rules,onKeyup:j(e.loginClick,["enter"])},{default:o(()=>[s(d,{class:"login-animation1",prop:"username"},{default:o(()=>[s(g,{type:"text",placeholder:e.$t("message.account.accountPlaceholder1"),readonly:"",modelValue:e.ruleForm.username,"onUpdate:modelValue":n[0]||(n[0]=l=>e.ruleForm.username=l),clearable:"",autocomplete:"off"},{prefix:o(()=>[s(c,{class:"el-input__icon"},{default:o(()=>[s(t)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),s(d,{class:"login-animation2",prop:"password"},{default:o(()=>[s(g,{type:e.isShowPassword?"text":"password",placeholder:e.$t("message.account.accountPlaceholder4"),modelValue:e.ruleForm.password,"onUpdate:modelValue":n[2]||(n[2]=l=>e.ruleForm.password=l)},{prefix:o(()=>[s(c,{class:"el-input__icon"},{default:o(()=>[s(i)]),_:1})]),suffix:o(()=>[y("i",{class:V(["iconfont el-input__icon login-content-password",e.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:n[1]||(n[1]=l=>e.isShowPassword=!e.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),s(d,{class:"login-animation3",prop:"password_regain"},{default:o(()=>[s(g,{type:e.isShowPassword?"text":"password",placeholder:e.$t("message.account.accountPlaceholder5"),modelValue:e.ruleForm.password_regain,"onUpdate:modelValue":n[4]||(n[4]=l=>e.ruleForm.password_regain=l)},{prefix:o(()=>[s(c,{class:"el-input__icon"},{default:o(()=>[s(i)]),_:1})]),suffix:o(()=>[y("i",{class:V(["iconfont el-input__icon login-content-password",e.isShowPassword?"icon-yincangmima":"icon-xianshimima"]),onClick:n[3]||(n[3]=l=>e.isShowPassword=!e.isShowPassword)},null,2)]),_:1},8,["type","placeholder","modelValue"])]),_:1}),s(d,{class:"login-animation4"},{default:o(()=>[s(f,{type:"primary",class:"login-content-submit",round:"",onClick:e.loginClick,loading:e.loading.signIn},{default:o(()=>[y("span",null,M(e.$t("message.account.accountBtnText")),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules","onKeyup"]),e.showApply()?($(),R("div",ne,[s(f,{class:"login-content-apply",link:"",type:"primary",plain:"",round:"",onClick:e.applyBtnClick},{default:o(()=>[...n[5]||(n[5]=[y("span",null,"申请试用",-1)])]),_:1},8,["onClick"])])):D("",!0)],64)}const pe=se(oe,[["render",ae],["__scopeId","data-v-3dad709b"]]);export{pe as default};
