import{X as R,E as V,z as g}from"./index.WrgjqPzT.js";import B from"./index.mJoC_on2.js";import N from"./index.DcPXfT0b.js";import F from"./index.BqR8g2zY.js";import{G as M,D as A}from"./api.X9Enok1h.js";import{d as x,h as l,j as E,k as d,b as v,o as C,w as c,l as s,e as b,u as n,$ as j,m as z}from"./vue.UJNVWY_g.js";import{_ as G}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./index.es.DmevZXPX.js";import"./md5.DLPczxzP.js";import"./crud.BpBW6uc-.js";import"./dictionary.BfwLo0Jv.js";import"./authFunction.BFEqkD6U.js";import"./index.vue_vue_type_script_setup_true_name_importExcel_lang.CMSwRQmp.js";import"./echarts.D5sl-F-p.js";const X={class:"dept-box dept-left"},I={class:"dept-box dept-table"},K=x({name:"dept"}),L=x({...K,setup(O){let p=l([]),_=l([]),o=l(!1),i=l({}),m=l(null),D=l(null);const f=async()=>{let e=await M({});if((e==null?void 0:e.code)===2e3&&Array.isArray(e.data)){const t=R.toArrayTree(e.data,{parentKey:"parent",children:"children"});p.value=t}},y=e=>{var t;(t=m.value)==null||t.handleDoRefreshUser(e.id)},T=(e,t)=>{V.confirm("您确认删除该部门吗?","温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{var r;const a=await A(e);t(),(a==null?void 0:a.code)===2e3&&(g(a.msg),f(),(r=m.value)==null||r.handleDoRefreshUser(""))})},k=(e,t)=>{var a,r;if(e==="update"&&t){const u=((r=(a=D.value)==null?void 0:a.treeRef)==null?void 0:r.currentNode.parent.data)||{};_.value=[u],i.value=t}o.value=!0},h=e=>{e==="submit"&&f(),o.value=!1,i.value={}};return E(()=>{f()}),(e,t)=>{const a=d("el-col"),r=d("el-row"),u=d("el-drawer"),U=d("fs-page");return C(),v(U,null,{default:c(()=>[s(r,{class:"dept-el-row"},{default:c(()=>[s(a,{span:6},{default:c(()=>[b("div",X,[s(B,{ref_key:"deptTreeRef",ref:D,treeData:n(p),onTreeClick:y,onUpdateDept:k,onDeleteDept:T},null,8,["treeData"])])]),_:1}),s(a,{span:18},{default:c(()=>[b("div",I,[s(F,{ref_key:"deptUserRef",ref:m},null,512)])]),_:1})]),_:1}),s(u,{modelValue:n(o),"onUpdate:modelValue":t[0]||(t[0]=w=>j(o)?o.value=w:o=w),title:"部门配置",direction:"rtl",size:"500px","close-on-click-modal":!1,"before-close":h},{default:c(()=>[n(o)?(C(),v(N,{key:0,initFormData:n(i),treeData:n(p),cacheData:n(_),onDrawerClose:h},null,8,["initFormData","treeData","cacheData"])):z("",!0)]),_:1},8,["modelValue"])]),_:1})}}}),re=G(L,[["__scopeId","data-v-24cbbb3f"]]);export{re as default};
