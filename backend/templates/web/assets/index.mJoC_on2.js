import{d as K,h as u,v as Q,k as a,a as w,o as C,l as t,e as v,u as c,$ as E,w as l,A as x,D as N,q as S,s as g,F as W,E as X,t as Y}from"./vue.UJNVWY_g.js";import{g as Z}from"./index.es.DmevZXPX.js";import{a7 as ee,a8 as te,P as z}from"./index.WrgjqPzT.js";import{d as oe,a as le,l as ne}from"./api.X9Enok1h.js";import{_ as ae}from"./_plugin-vue_export-helper.DlAUqK2U.js";const se={class:"dept-tree-com"},ie={class:"tc-head"},de={key:0,class:"text-center font-black font-normal"},ce={key:1,color:"var(--el-color-primary)"},re={class:"tree-tags"},ue=K({__name:"index",props:{treeData:{default:()=>[]}},emits:["treeClick","deleteDept","updateDept"],setup(B,{expose:F,emit:H}){const I=Z(X),P={children:"children",label:"name",isLeaf:(o,e)=>!e.data.hasChild},h=H;let f=u(""),r=u(!1),p=u(!1),s=u({}),L=u(null);const D=u();Q(f,o=>{D.value.filter(o)});const R=(o,e)=>{var n;return o?((n=Y(e).name)==null?void 0:n.indexOf(o))!==-1:!0},$=(o,e)=>{o.level!==0&&ne({parent:o.data.id}).then(n=>{e(n.data)})},M=(o,e)=>{s.value=o,L.value=e,h("treeClick",o)},T=o=>{if(o==="update"){if(!s.value.id){z("请选择菜单！");return}h("updateDept",o,s.value)}else h("updateDept",o)},U=()=>{if(!s.value.id){z("请选择菜单！");return}h("deleteDept",s.value.id,()=>{s.value={}})},V=async o=>{var i;if(!s.value.id){z("请选择菜单！");return}if(p.value)return;const e=((i=L.value)==null?void 0:i.parent.childNodes)||[],n=e.findIndex(m=>m.data.id===s.value.id),k=e.find(m=>m.data.id===s.value.id);if(o==="up"){if(n===0)return;e.splice(n-1,0,k),e.splice(n+1,1),p.value=!0,await oe({dept_id:s.value.id}),p.value=!1}o==="down"&&(e.splice(n+2,0,k),e.splice(n,1),p.value=!0,await le({dept_id:s.value.id}),p.value=!1)};return F({treeRef:D}),(o,e)=>{const n=a("el-input"),k=a("HomeFilled"),i=a("el-icon"),m=a("View"),q=a("Hide"),y=a("SvgIcon"),A=a("Plus"),_=a("el-tooltip"),O=a("Edit"),j=a("Top"),G=a("Bottom"),J=a("Delete");return C(),w(W,null,[t(n,{modelValue:c(f),"onUpdate:modelValue":e[0]||(e[0]=d=>E(f)?f.value=d:f=d),"prefix-icon":c(ee),placeholder:"请输入部门名称"},null,8,["modelValue","prefix-icon"]),v("div",se,[v("div",ie,[t(i,{size:"16",color:"#606266",class:"tc-head-icon"},{default:l(()=>[t(k)]),_:1}),e[6]||(e[6]=v("span",{class:"tc-head-txt"},"部门架构",-1)),t(i,{size:"16",color:"#606266",onClick:e[1]||(e[1]=()=>E(r)?r.value=!c(r):r=!c(r)),class:"tc-head-icon"},{default:l(()=>[x(t(m,null,null,512),[[N,!c(r)]]),x(t(q,null,null,512),[[N,c(r)]])]),_:1})]),t(c(te),{ref_key:"treeRef",ref:D,data:B.treeData,props:P,"filter-node-method":R,load:$,lazy:"",indent:38,onNodeClick:M,"highlight-current":""},{default:l(({node:d,data:b})=>[t(c(I),{node:d,showLabelLine:!1,indent:32},{default:l(()=>[b.status?(C(),w("span",de,[t(y,{name:"iconfont icon-shouye",color:"var(--el-color-primary)"}),S(" "+g(d.label)+" ",1),x(v("span",null,"（"+g(b.dept_user_count)+"人）",513),[[N,c(r)]])])):(C(),w("span",ce,[t(y,{name:"iconfont icon-shouye"}),S(" "+g(d.label),1)]))]),_:2},1032,["node"])]),_:1},8,["data"]),v("div",re,[t(_,{effect:"dark",content:"新增"},{default:l(()=>[t(i,{size:"16",onClick:e[2]||(e[2]=d=>T("create")),class:"mlt-icon"},{default:l(()=>[t(A)]),_:1})]),_:1}),t(_,{effect:"dark",content:"编辑"},{default:l(()=>[t(i,{size:"16",onClick:e[3]||(e[3]=d=>T("update")),class:"mlt-icon"},{default:l(()=>[t(O)]),_:1})]),_:1}),t(_,{effect:"dark",content:"上移"},{default:l(()=>[t(i,{size:"16",onClick:e[4]||(e[4]=d=>V("up")),class:"mlt-icon"},{default:l(()=>[t(j)]),_:1})]),_:1}),t(_,{effect:"dark",content:"下移"},{default:l(()=>[t(i,{size:"16",onClick:e[5]||(e[5]=d=>V("down")),class:"mlt-icon"},{default:l(()=>[t(G)]),_:1})]),_:1}),t(_,{effect:"dark",content:"删除"},{default:l(()=>[t(i,{size:"16",onClick:U,class:"mlt-icon"},{default:l(()=>[t(J)]),_:1})]),_:1})])])],64)}}}),he=ae(ue,[["__scopeId","data-v-0a1dffe4"]]);export{he as default};
